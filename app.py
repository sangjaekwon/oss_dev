import streamlit as st
import pandas as pd
import plotly.express as px
import folium
from streamlit_folium import folium_static
import chardet

# ---- ë°ì´í„° ë¡œë”© ----
@st.cache_data
def load_data():
    # ì¸ì½”ë”© ìë™ ê°ì§€
    with open("accident_stats.csv", "rb") as f:
        result = chardet.detect(f.read())
        encoding = result["encoding"]
    
    df = pd.read_csv("accident_stats.csv", encoding=encoding)
    
    # ì»¬ëŸ¼ëª… ì „ì²˜ë¦¬ (ì—¬ê¸°ì„œëŠ” ê³µë°± ì œê±°)
    df.columns = df.columns.str.strip()
    return df

df = load_data()

# ---- ì‚¬ì´ë“œë°” í•„í„° ----
st.sidebar.header("ğŸ§ª í•„í„° ì„¤ì •")
selected_sido = st.sidebar.multiselect("ì‹œë„", df["ì‹œë„"].unique())

# ---- í•„í„° ì ìš© ----
filtered = df[df["ì‹œë„"].isin(selected_sido)]  # ì„ íƒí•œ ì‹œë„ì— ë§ëŠ” ë°ì´í„° í•„í„°ë§

st.title("ğŸš§ ì‹œë„/ì‹œêµ°êµ¬ë³„ êµí†µì‚¬ê³  í†µê³„ ë¶„ì„")
st.write(f"â–¶ï¸ ì„ íƒëœ ì‹œë„: {', '.join(selected_sido)}")

# ---- ë°ì´í„° í‘œ ----
st.subheader("ğŸ“‹ ì‚¬ê³  í†µê³„ í…Œì´ë¸”")
st.dataframe(filtered)

# ---- ì‹œêµ°êµ¬ë³„ ì‚¬ê³  ë°œìƒ ê±´ìˆ˜ ----
st.subheader("ğŸ“Š ì‹œêµ°êµ¬ë³„ ì‚¬ê³  ë°œìƒê±´ìˆ˜")
bar = px.bar(filtered, x="ì‹œêµ°êµ¬", y="ì‚¬ê³ ê±´ìˆ˜", color="ì‹œë„", title="ì‹œêµ°êµ¬ë³„ ì‚¬ê³  ë°œìƒê±´ìˆ˜")
st.plotly_chart(bar)

# ---- ì‹œêµ°êµ¬ë³„ ë¶€ìƒì ìœ í˜• ë¹„êµ ----
st.subheader("ğŸ¤• ë¶€ìƒì ìœ í˜• ë¹„êµ")
injury_df = filtered[["ì‹œêµ°êµ¬", "ì¤‘ìƒììˆ˜", "ê²½ìƒììˆ˜", "ë¶€ìƒì‹ ê³ ììˆ˜"]].melt(
    id_vars="ì‹œêµ°êµ¬", var_name="ë¶€ìƒììœ í˜•", value_name="ì¸ì›ìˆ˜"
)
injury_chart = px.bar(injury_df, x="ì‹œêµ°êµ¬", y="ì¸ì›ìˆ˜", color="ë¶€ìƒììœ í˜•", barmode="group", title="ì‹œêµ°êµ¬ë³„ ë¶€ìƒì ìœ í˜• ë¹„êµ")
st.plotly_chart(injury_chart)

# ---- ì§€ë„ ì‹œê°í™” ----
st.subheader("ğŸ—ºï¸ ì‚¬ê³  ê±´ìˆ˜ ì§€ë„ ì‹œê°í™” (ëŒ€í•œë¯¼êµ­ ì „ì²´)")

# ëŒ€í•œë¯¼êµ­ ì‹œêµ°êµ¬ ì¢Œí‘œ (ì‹œë„ë³„ ëŒ€ëµì ì¸ ì¢Œí‘œ ì˜ˆì‹œ)
location_data = {
    # ì„œìš¸
    'ì¢…ë¡œêµ¬': [37.5729503, 126.9793579],
    'ì¤‘êµ¬': [37.5638439, 126.997602],
    'ìš©ì‚°êµ¬': [37.5324275, 126.990146],
    'ì„±ë™êµ¬': [37.550978, 127.040580],
    'ê´‘ì§„êµ¬': [37.538484, 127.082293],
    'ë™ëŒ€ë¬¸êµ¬': [37.574368, 127.039569],
    'ì¤‘ë‘êµ¬': [37.606991, 127.092789],
    'ì„±ë¶êµ¬': [37.589400, 127.016637],
    'ê°•ë¶êµ¬': [37.646995, 127.014573],
    'ì€í‰êµ¬': [37.6027, 126.9330],
    'ì„œëŒ€ë¬¸êµ¬': [37.5775, 126.9369],
    'ë§ˆí¬êµ¬': [37.5660, 126.9052],
    'ê°•ì„œêµ¬': [37.5507, 126.8494],
    'êµ¬ë¡œêµ¬': [37.4951, 126.8848],
    'ì˜ë“±í¬êµ¬': [37.5266, 126.9007],
    'ë™ì‘êµ¬': [37.5115, 126.9399],
    'ê´€ì•…êµ¬': [37.4785, 126.9518],
    'ê°•ë‚¨êµ¬': [37.5172, 127.0473],
    'ê°•ë™êµ¬': [37.5300, 127.1207],
    'ì†¡íŒŒêµ¬': [37.5143, 127.1056],
    'ì„œì´ˆêµ¬': [37.4830, 127.0324],
    'ì–‘ì²œêµ¬': [37.5135, 126.8748],
    'ë…¸ì›êµ¬': [37.6565, 127.0777],
    'ê´‘ì§„êµ¬': [37.538484, 127.082293],
    'ê°•ë¶êµ¬': [37.646995, 127.014573],
    'ê¸ˆì²œêµ¬': [37.4523, 126.9004],
    'ë„ë´‰êµ¬': [37.6548, 127.0298],
    # ê²½ë¶
    'í¬í•­ì‹œ': [36.0195, 129.3434],
    'ê²½ì£¼ì‹œ': [35.8480, 129.2111],
    'ê¹€ì²œì‹œ': [36.1375, 128.1123],
    'ì•ˆë™ì‹œ': [36.5660, 128.7407],
    'êµ¬ë¯¸ì‹œ': [36.1195, 128.3449],
    'ì˜ì£¼ì‹œ': [36.7799, 128.6090],
    'ìƒì£¼ì‹œ': [36.4344, 128.1574],
    'ë¬¸ê²½ì‹œ': [36.5951, 128.1891],
    'ê²½ì‚°ì‹œ': [35.8245, 128.7417],
    'ìš¸ì§„êµ°': [36.9939, 129.3965],
    'ìš¸ë¦‰êµ°': [37.4837, 130.9052],
    'ì˜ˆì²œêµ°': [36.6555, 128.2700],
    'ì²­ì†¡êµ°': [36.4420, 129.1046],
    'ì˜ì–‘êµ°': [36.4934, 129.1021],
    'ì˜ë•êµ°': [36.5184, 129.3665],
    'ë´‰í™”êµ°': [36.8980, 128.8642],
    'ì¹ ê³¡êµ°': [35.9864, 128.6804],
    'ì„±ì£¼êµ°': [35.8836, 128.2194],
    'ê³ ë ¹êµ°': [35.7115, 128.2826],
    # ë¶€ì‚°
    'ì¤‘êµ¬': [35.1796, 129.0756],
    'ì„œêµ¬': [35.0703, 129.0247],
    'ë™êµ¬': [35.1031, 129.0326],
    'ì˜ë„êµ¬': [35.0916, 129.0729],
    'ë¶€ì‚°ì§„êµ¬': [35.1607, 129.0578],
    'ë™ë˜êµ¬': [35.2321, 129.0717],
    'ë‚¨êµ¬': [35.1283, 129.0703],
    'ë¶êµ¬': [35.1794, 129.0149],
    'í•´ìš´ëŒ€êµ¬': [35.1621, 129.1636],
    'ì‚¬í•˜êµ¬': [35.0893, 128.9995],
    'ê¸ˆì •êµ¬': [35.2367, 129.0985],
    'ê°•ì„œêµ¬': [35.1595, 129.1699],
    'ì—°ì œêµ¬': [35.1697, 129.0601],
    'ìˆ˜ì˜êµ¬': [35.1647, 129.1161],
    'ì‚¬ìƒêµ¬': [35.1467, 128.9967],
    'ê¸°ì¥êµ°': [35.2358, 129.2257],
    
    # ê²½ê¸°
    'ìˆ˜ì›ì‹œ': [37.2636, 127.0286],
    'ì„±ë‚¨ì‹œ': [37.4384, 127.1371],
    'ì˜ì •ë¶€ì‹œ': [37.7395, 127.0372],
    'ì•ˆì–‘ì‹œ': [37.3945, 126.9393],
    'ë¶€ì²œì‹œ': [37.4830, 126.7735],
    'ì•ˆì‚°ì‹œ': [37.3210, 126.8319],
    'í‰íƒì‹œ': [37.0020, 127.1236],
    'ê´‘ëª…ì‹œ': [37.4786, 126.8736],
    'êµ¬ë¦¬ì‹œ': [37.5942, 127.1275],
    'ì–‘ì£¼ì‹œ': [37.7596, 127.0335],
    'ì—¬ì£¼ì‹œ': [37.2953, 127.6351],
    'í™”ì„±ì‹œ': [37.2041, 127.8355],
    'ì‹œí¥ì‹œ': [37.4520, 126.7736],
    'íŒŒì£¼ì‹œ': [37.7595, 126.7708],
    'ê³ ì–‘ì‹œ': [37.6584, 126.8320],
    'ê´‘ì£¼ì‹œ': [37.3214, 127.2514],
    'ì—°ì²œêµ°': [38.0710, 127.1762],
    'í¬ì²œì‹œ': [37.8977, 127.2004],
    'ê°€í‰êµ°': [37.8321, 127.5156],
    'ì–‘í‰êµ°': [37.4975, 127.4736],
    'ì´ì²œì‹œ': [37.2744, 127.4883],
    'ìš©ì¸ì‹œ': [37.2412, 127.1780],
    'ì•ˆì„±ì‹œ': [37.0105, 127.2722],
    'ê¹€í¬ì‹œ': [37.6305, 126.7318],
    'ë™ë‘ì²œì‹œ': [37.9030, 127.1382],
    'ê³¼ì²œì‹œ': [37.4234, 126.9984],
    'êµ°í¬ì‹œ': [37.3582, 126.9274],
    'ë‚¨ì–‘ì£¼ì‹œ': [37.6357, 127.1777],
    'ì˜¤ì‚°ì‹œ': [37.1500, 127.0669],
    'ì˜ì™•ì‹œ': [37.3380, 126.9866],
    'í•˜ë‚¨ì‹œ': [37.5285, 127.2206],
    
    # ì¸ì²œ
    'ì¤‘êµ¬': [37.4685, 126.6168],
    'ë™êµ¬': [37.4744, 126.6452],
    'ë¯¸ì¶”í™€êµ¬': [37.4557, 126.6380],
    'ì—°ìˆ˜êµ¬': [37.4097, 126.6604],
    'ë‚¨ë™êµ¬': [37.4510, 126.7177],
    'ë¶€í‰êµ¬': [37.4964, 126.7107],
    'ê³„ì–‘êµ¬': [37.5300, 126.7237],
    'ì„œêµ¬': [37.5974, 126.6507],
    'ê°•í™”êµ°': [37.7579, 126.5000],
    'ì˜¹ì§„êµ°': [37.3009, 126.4044],
    
    # ëŒ€êµ¬
    'ì¤‘êµ¬': [35.8665, 128.5910],
    'ë™êµ¬': [35.8766, 128.6177],
    'ì„œêµ¬': [35.8671, 128.5779],
    'ë‚¨êµ¬': [35.8454, 128.6022],
    'ë¶êµ¬': [35.8965, 128.6101],
    'ìˆ˜ì„±êµ¬': [35.8447, 128.6597],
    'ë‹¬ì„œêµ¬': [35.8466, 128.5990],
    'ë‹¬ì„±êµ°': [35.8311, 128.4591],
    
    # ê²½ë‚¨
    'ì°½ì›ì‹œ': [35.2275, 128.6816],
    'ì§„ì£¼ì‹œ': [35.1760, 128.1100],
    'í†µì˜ì‹œ': [34.8580, 128.4337],
    'ì‚¬ì²œì‹œ': [35.0133, 128.1262],
    'ê¹€í•´ì‹œ': [35.2322, 128.8813],
    'ë°€ì–‘ì‹œ': [35.4877, 128.7424],
    'ê±°ì œì‹œ': [34.8813, 128.6071],
    'ì–‘ì‚°ì‹œ': [35.3382, 129.0290],
    'í•˜ë™êµ°': [35.2797, 127.8224],
    'í•©ì²œêµ°': [35.5535, 128.1311],
    'ê±°ì°½êµ°': [35.6293, 127.9227],
    'í•¨ì–‘êµ°': [35.3909, 127.8152],
    'ì‚°ì²­êµ°': [35.3287, 127.9513],
    'ì°½ë…•êµ°': [35.1855, 128.3691],
    'ê³ ì„±êµ°': [34.9781, 128.4351],
    
    # ê´‘ì£¼
    'ë™êµ¬': [35.1596, 126.9183],
    'ì„œêµ¬': [35.1582, 126.9286],
    'ë‚¨êµ¬': [35.1322, 126.9245],
    'ë¶êµ¬': [35.1867, 126.9152],
    'ê´‘ì‚°êµ¬': [35.2208, 126.7995],
    
    # ëŒ€ì „
    'ë™êµ¬': [36.3235, 127.4352],
    'ì¤‘êµ¬': [36.3211, 127.3849],
    'ì„œêµ¬': [36.3294, 127.3664],
    'ìœ ì„±êµ¬': [36.3593, 127.3491],
    'ëŒ€ë•êµ¬': [36.3503, 127.4406],
    
    # ìš¸ì‚°
    'ì¤‘êµ¬': [35.5345, 129.3116],
    'ë‚¨êµ¬': [35.5284, 129.3246],
    'ë™êµ¬': [35.5096, 129.4209],
    'ë¶êµ¬': [35.5821, 129.3545],
    'ìš¸ì£¼êµ°': [35.5370, 129.2163],
    
    # ì„¸ì¢…
    'ì„¸ì¢…ì‹œ': [36.4804, 127.2896],
    
    # ê²½ê¸°
    'ìˆ˜ì›ì‹œ': [37.2636, 127.0286],
    'ì„±ë‚¨ì‹œ': [37.4384, 127.1371],
    'ì˜ì •ë¶€ì‹œ': [37.7395, 127.0372],
    'ì•ˆì–‘ì‹œ': [37.3945, 126.9393],
    'ë¶€ì²œì‹œ': [37.4830, 126.7735],
    'ì•ˆì‚°ì‹œ': [37.3210, 126.8319],
    'í‰íƒì‹œ': [37.0020, 127.1236],
    'ê´‘ëª…ì‹œ': [37.4786, 126.8736],
    'êµ¬ë¦¬ì‹œ': [37.5942, 127.1275],
    'ì–‘ì£¼ì‹œ': [37.7596, 127.0335],
    'ì—¬ì£¼ì‹œ': [37.2953, 127.6351],
    'í™”ì„±ì‹œ': [37.2041, 127.8355],
    'ì‹œí¥ì‹œ': [37.4520, 126.7736],
    'íŒŒì£¼ì‹œ': [37.7595, 126.7708],
    'ê³ ì–‘ì‹œ': [37.6584, 126.8320],
    'ê´‘ì£¼ì‹œ': [37.3214, 127.2514],
    'ì—°ì²œêµ°': [38.0710, 127.1762],
    'í¬ì²œì‹œ': [37.8977, 127.2004],
    'ê°€í‰êµ°': [37.8321, 127.5156],
    'ì–‘í‰êµ°': [37.4975, 127.4736],
    'ì´ì²œì‹œ': [37.2744, 127.4883],
    'ìš©ì¸ì‹œ': [37.2412, 127.1780],
    'ì•ˆì„±ì‹œ': [37.0105, 127.2722],
    'ê¹€í¬ì‹œ': [37.6305, 126.7318],
    'ë™ë‘ì²œì‹œ': [37.9030, 127.1382],
    'ê³¼ì²œì‹œ': [37.4234, 126.9984],
    'êµ°í¬ì‹œ': [37.3582, 126.9274],
    'ë‚¨ì–‘ì£¼ì‹œ': [37.6357, 127.1777],
    'ì˜¤ì‚°ì‹œ': [37.1500, 127.0669],
    'ì˜ì™•ì‹œ': [37.3380, 126.9866],
    'í•˜ë‚¨ì‹œ': [37.5285, 127.2206],
    
    # ê°•ì›
    'ì¶˜ì²œì‹œ': [37.8756, 127.7308],
    'ì›ì£¼ì‹œ': [37.3475, 127.9536],
    'ë™í•´ì‹œ': [37.5200, 129.1141],
    'ê°•ë¦‰ì‹œ': [37.7510, 128.8769],
    'ì†ì´ˆì‹œ': [38.2084, 128.5919],
    'íƒœë°±ì‹œ': [37.5082, 128.9876],
    'ì‚¼ì²™ì‹œ': [38.4386, 128.1972],
    'í™ì²œêµ°': [37.7113, 127.8954],
    'íš¡ì„±êµ°': [37.4410, 128.2124],
    'ì˜ì›”êµ°': [37.1890, 128.2184],
    'í‰ì°½êµ°': [37.4144, 128.3907],
    'ì •ì„ êµ°': [37.4355, 128.1905],
    'ì² ì›êµ°': [38.2039, 127.3030],
    'í™”ì²œêµ°': [38.0856, 127.7342],
    'ì–‘êµ¬êµ°': [38.1155, 127.9393],
    'ì¸ì œêµ°': [38.1455, 128.1826],
    'ê³ ì„±êµ°': [38.3159, 128.4143],
    'ì–‘ì–‘êµ°': [38.0866, 128.5384],
    
    # ì¶©ë¶
    'ì²­ì£¼ì‹œ': [36.6352, 127.4912],
    'ì¶©ì£¼ì‹œ': [36.9875, 127.9319],
    'ì œì²œì‹œ': [37.1392, 128.1894],
    'ë³´ì€êµ°': [36.4482, 127.7249],
    'ì˜¥ì²œêµ°': [36.3312, 127.6169],
    'ì˜ë™êµ°': [36.1490, 127.6880],
    'ì§„ì²œêµ°': [36.8040, 127.4627],
    'ê´´ì‚°êµ°': [36.6760, 127.7881],
    'ìŒì„±êµ°': [36.7663, 127.5622],
    'ë‹¨ì–‘êµ°': [36.9971, 127.5200],
    'ì¦í‰êµ°': [36.7016, 127.6211],
    
    # ì¶©ë‚¨
    'ì²œì•ˆì‹œ': [36.3504, 127.3845],
    'ì•„ì‚°ì‹œ': [36.7757, 127.0271],
    'ë³´ë ¹ì‹œ': [36.3697, 126.5893],
    'ê³µì£¼ì‹œ': [36.4679, 127.1217],
    'ì„œì‚°ì‹œ': [36.7762, 126.4513],
    'ê¸ˆì‚°êµ°': [36.1149, 127.5614],
    'íƒœì•ˆêµ°': [36.7190, 126.2613],
    'í™ì„±êµ°': [36.6651, 126.6954],
    'ì˜ˆì‚°êµ°': [36.6753, 126.7571],
    'ì²­ì–‘êµ°': [36.4690, 126.7470],
    'ë¶€ì—¬êµ°': [36.2869, 126.9330],
    'ì„œì²œêµ°': [36.0299, 126.5373],
    # ì „ë¶
    'ì „ì£¼ì‹œ': [35.8240, 127.1500],
    'ìµì‚°ì‹œ': [35.9504, 126.9779],
    'êµ°ì‚°ì‹œ': [35.9740, 126.7375],
    'ì •ìì‹œ': [35.5631, 126.8444],
    'ë‚¨ì›ì‹œ': [35.3767, 127.4049],
    'ê¹€ì œì‹œ': [35.8147, 126.8541],
    'ì™„ì£¼êµ°': [35.9025, 127.2041],
    'ì§„ì•ˆêµ°': [35.6430, 127.3657],
    'ë¬´ì£¼êµ°': [35.7715, 127.7371],
    'ì¥ìˆ˜êµ°': [35.5225, 127.2673],
    'ì„ì‹¤êµ°': [35.5819, 127.2079],
    'ìˆœì°½êµ°': [35.4524, 127.2305],
    'ê³ ì°½êµ°': [35.4413, 126.7014],
    'ë¶€ì•ˆêµ°': [35.7209, 126.7282],
    
    # ì „ë‚¨
    'ëª©í¬ì‹œ': [34.8106, 126.3922],
    'ì—¬ìˆ˜ì‹œ': [34.7605, 127.6628],
    'ìˆœì²œì‹œ': [34.9506, 127.4874],
    'ê´‘ì–‘ì‹œ': [34.9507, 127.6701],
    'ë‹´ì–‘êµ°': [35.3253, 127.1521],
    'ê³¡ì„±êµ°': [35.3064, 127.2900],
    'êµ¬ë¡€êµ°': [35.2321, 127.4486],
    'ê³ í¥êµ°': [34.5906, 127.2039],
    'ë³´ì„±êµ°': [34.7559, 127.1134],
    'í™”ìˆœêµ°': [35.0322, 126.9709],
    'ì¥í¥êµ°': [34.6330, 126.8840],
    'ê°•ì§„êµ°': [34.6104, 126.7342],
    'í•´ë‚¨êµ°': [34.5662, 126.5917],
    'ì˜ì•”êµ°': [34.6572, 126.7232],
    'ë¬´ì•ˆêµ°': [34.9759, 126.3929],
    'í•¨í‰êµ°': [34.8830, 126.5280],
    'ì˜ê´‘êµ°': [35.2811, 126.5181],
    'ì™„ë„êµ°': [34.3049, 126.7420],
    'ì§„ë„êµ°': [34.4840, 126.2217],
    'ì‹ ì•ˆêµ°': [34.7001, 126.0814],
}

# ì§€ë„ ìƒì„±
m = folium.Map(location=[36.9875, 127.5319], zoom_start=7)

# ê° ì‹œë„ì˜ ìœ„ë„, ê²½ë„ ë²”ìœ„ ì„¤ì •
# ì„œìš¸
seoul_lat_range = (37.0, 38.0)
seoul_lon_range = (127.0, 127.5)

# ë¶€ì‚°
busan_lat_range = (34.5, 35.5)
busan_lon_range = (128.5, 129.5)

# ëŒ€êµ¬
daegu_lat_range = (35.5, 36.3)
daegu_lon_range = (128.0, 129.0)

# ì¸ì²œ
incheon_lat_range = (37.0, 38.0)
incheon_lon_range = (126.0, 127.0)

# ëŒ€ì „
daejeon_lat_range = (36.0, 37.0)
daejeon_lon_range = (127.0, 128.0)

# ìš¸ì‚°
ulsan_lat_range = (35.0, 36.0)
ulsan_lon_range = (129.0, 130.0)

# ê²½ê¸°
gyeonggi_lat_range = (36.5, 38.5)
gyeonggi_lon_range = (126.0, 128.0)

# ê²½ë‚¨
gyeongnam_lat_range = (34.5, 36.0)
gyeongnam_lon_range = (127.5, 129.5)

# ê²½ë¶
gyeongbuk_lat_range = (30.7, 38.0)
gyeongbuk_lon_range = (126.5, 132.2)

# ì „ë‚¨
jeonnam_lat_range = (34.0, 35.5)
jeonnam_lon_range = (125.1, 127.0)

# ì „ë¶
jeonbuk_lat_range = (35.0, 36.5)
jeonbuk_lon_range = (126.5, 128.0)

# ì„¸ì¢…
sejong_lat_range = (36.0, 37.0)
sejong_lon_range = (127.0, 127.5)

# ê°•ì›
gangwon_lat_range = (37.0, 38.5)
gangwon_lon_range = (127.0, 129.5)

# ì¶©ë¶
chungbuk_lat_range = (36.0, 37.5)
chungbuk_lon_range = (127.0, 128.5)

# ì¶©ë‚¨
chungnam_lat_range = (36.0, 37.5)
chungnam_lon_range = (126.0, 128.0)

# ì‹œë„ë³„ ë²”ìœ„ ë”•ì…”ë„ˆë¦¬
city_lat_lon_range = {
    'ì„œìš¸': (seoul_lat_range, seoul_lon_range),
    'ë¶€ì‚°': (busan_lat_range, busan_lon_range),
    'ëŒ€êµ¬': (daegu_lat_range, daegu_lon_range),
    'ì¸ì²œ': (incheon_lat_range, incheon_lon_range),
    'ëŒ€ì „': (daejeon_lat_range, daejeon_lon_range),
    'ìš¸ì‚°': (ulsan_lat_range, ulsan_lon_range),
    'ê²½ê¸°': (gyeonggi_lat_range, gyeonggi_lon_range),
    'ê²½ë‚¨': (gyeongnam_lat_range, gyeongnam_lon_range),
    'ê²½ë¶': (gyeongbuk_lat_range, gyeongbuk_lon_range),
    'ì „ë‚¨': (jeonnam_lat_range, jeonnam_lon_range),
    'ì „ë¶': (jeonbuk_lat_range, jeonbuk_lon_range),
    'ì„¸ì¢…': (sejong_lat_range, sejong_lon_range),
    'ê°•ì›': (gangwon_lat_range, gangwon_lon_range),
    'ì¶©ë¶': (chungbuk_lat_range, chungbuk_lon_range),
    'ì¶©ë‚¨': (chungnam_lat_range, chungnam_lon_range)
}

# í•„í„°ë§ëœ ì‹œêµ°êµ¬ì— ëŒ€í•´ì„œë§Œ ë§ˆì»¤ í‘œì‹œ
for _, row in filtered.iterrows():
    sido = row['ì‹œë„']
    sigungu = row['ì‹œêµ°êµ¬']
    
    if sigungu in location_data:  # ì¢Œí‘œ ë°ì´í„°ê°€ ìˆëŠ” ê²½ìš°ì—ë§Œ í‘œì‹œ
        latitude, longitude = location_data[sigungu]
        
        # í•´ë‹¹ ì‹œë„ì˜ ë²”ìœ„ ê°€ì ¸ì˜¤ê¸°
        if sido in city_lat_lon_range:
            lat_range, lon_range = city_lat_lon_range[sido]
            
            # ì‹œë„ì˜ ë²”ìœ„ ì•ˆì— ìˆëŠ” ì¢Œí‘œë§Œ ë§ˆì»¤ í‘œì‹œ
            if lat_range[0] <= latitude <= lat_range[1] and lon_range[0] <= longitude <= lon_range[1]:
                accident_count = row['ì‚¬ê³ ê±´ìˆ˜']
                
                # ë§ˆì»¤ ì¶”ê°€
                folium.CircleMarker(
                    location=[latitude, longitude],
                    radius=5,
                    color="blue",
                    fill=True,
                    fill_color="blue",
                    fill_opacity=0.6,
                    popup=f"{sigungu} ì‚¬ê³ ê±´ìˆ˜: {accident_count}",
                ).add_to(m)

# ì§€ë„ ì¶œë ¥
folium_static(m)
